extends layout

block header
  link(rel="stylesheet", href="/admin/css/post.css")
  script(type="text/javascript", src="/admin/js/knockout-2.2.1.js")
  script(type="text/javascript").
    
    $(function () {
      // delete post
      $('a.delete').click(function () {
        var tr = $(this).parents('tr');
        var id = $(this).attr('data-id');
        if (confirm('确定要删除这篇文章吗？')) {
          $.ajax({url: '#{admin_url}/post', data: {_id: id}, success: function () {
            //location.reload();
            tr.remove();
          }, type: 'delete'});
        }
      });
    });

block links
  a.black(href='#{admin_url}/post/create') #{__('addPost')}

block content
  // display Post list
  table.table.table-bordered.table-striped(style='width: 100%')
    tr
      th #{__('title')}
      th #{__('createAt')}
      th #{__('view')}
      th #{__('isPublic')}
      th #{__('operate')}
    - each post in posts
      tr
        td
          a(href="/#{post.url}", target='_blank') #{post.title}
        td #{post.create_date}
        td #{post.views}
        td #{post.public}
        td 
          div.btn-group
            a.edit.btn.btn-small(href="#{admin_url}/post/edit/#{post._id}")
              i.icon-edit
              &nbsp;#{__('edit')}
            button.btn.btn-small.dropdown-toggle(data-toggle="dropdown")
              span.caret
            ul.dropdown-menu.pull-right
              li
                a.delete(href="#", data-id='#{post._id}')
                  i.icon-remove-sign
                  &nbsp;#{__('delete')}
